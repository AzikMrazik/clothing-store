meta:
  environment: node
  toolchain:
    name: npm
    version: "16"

build:
  additionalCommands:
    - cd backend && npm install
    - cd ../frontend && npm install && npm run build
    - mkdir -p ../backend/public
    - cp -r ../frontend/dist/* ../backend/public/
    - cd ..

run:
  command: cd backend && npm run start
  persistenceMount: /app/uploads
  containerPort: 3001
  env:
    NODE_ENV: production
    # Другие переменные окружения будут добавлены через интерфейс Amvera